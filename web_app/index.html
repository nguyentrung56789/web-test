<!-- ====================== Báº®T Äáº¦U: index.html ====================== -->
<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>ÄÄƒng nháº­p â†’ QuÃ©t mÃ£</title>

<link rel="manifest" href="/manifest.webmanifest">
<meta name="theme-color" content="#1a73e8">
<script>if('serviceWorker'in navigator){addEventListener('load',()=>navigator.serviceWorker.register('/sw.js').catch(()=>{}));}</script>

<script src="./internal_key.js"></script>
<script src="./cod_config.js"></script>
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<script src="https://unpkg.com/@zxing/library@latest"></script>

<!-- CSS Ä‘Ã£ tÃ¡ch -->
<link rel="stylesheet" href="./app_dh.css" />
</head>
<body>
<div class="wrap">
  <!-- LOGIN -->
  <section id="login" class="card">
    <h2 style="margin:6px 0 10px">ğŸ” ÄÄƒng nháº­p nhÃ¢n viÃªn</h2>
    <div class="grid">
      <div><label>MÃ£ nhÃ¢n viÃªn</label><input id="ma_nv" placeholder="VD: NV001" autocomplete="username" autocapitalize="none"></div>
      <div><label>Máº­t kháº©u</label><input id="mat_khau" type="password" placeholder="Máº­t kháº©u" autocomplete="current-password"></div>
      <button id="btnLogin" class="btn">ÄÄƒng nháº­p</button>
      <div id="loginMsg" class="muted"></div>
    </div>
  </section>

  <!-- APP -->
  <section id="app" style="display:none">
    <div class="top">
      <div class="row">
        <button id="startBtn" class="cam-btn">ğŸ“· Báº­t camera</button>
        <button id="refreshBtn" class="small-btn">â™»ï¸ LÃ m tÆ°Æ¡i</button>
        <button id="installBtn" class="small-btn install-btn">ğŸ“² CÃ i Ä‘áº·t</button>
      </div>
      <div class="user">
        <button class="user-btn" id="userBtn"><span id="who">ğŸ‘¤</span><i class="caret"></i></button>
        <div class="menu" id="userMenu"><button id="logout">ÄÄƒng xuáº¥t</button></div>
      </div>
    </div>

    <div class="card" style="display:flex;justify-content:center;margin-top:8px">
      <div class="seg">
        <input type="radio" name="mode" id="modeHang" value="hang" checked><label for="modeHang" id="lblHang">QuÃ©t hÃ³a Ä‘Æ¡n</label>
        <input type="radio" name="mode" id="modeVD" value="vd"><label for="modeVD" id="lblVD">QuÃ©t mÃ£ váº­n Ä‘Æ¡n</label>
      </div>
    </div>

    <div class="info-bar" id="info">Sáºµn sÃ ng quÃ©t. Nháº¥n â€œBáº­t cameraâ€.</div>

    <div class="card video-wrap" id="camCard">
      <video id="preview" playsinline autoplay muted></video>
      <div class="scan-box"></div>
    </div>

    <div class="card">
      <div id="statusText" class="info-bar" style="margin:0">Tráº¡ng thÃ¡i giao hÃ ng</div>
    </div>

    <div class="card">
      <div id="rowVD" style="display:none"><label>MÃ£ váº­n Ä‘Æ¡n</label><input id="mavd" placeholder="Tá»± Ä‘iá»n sau khi quÃ©t"></div>
      <div id="rowDon"><label>MÃ£ Ä‘Æ¡n</label><input id="madon" placeholder="Tá»± Ä‘iá»n sau khi quÃ©t"></div>
      <button id="saveBtn" class="btn" style="margin-top:10px">Cáº­p nháº­t</button>
      <div class="muted" style="margin-top:6px"></div>
    </div>
  </section>
</div>

<!-- Thanh Ä‘Ã¡y -->
<nav class="bottom-bar">
  <div class="bar-item"><button id="tabOrders">ÄÆ¡n hÃ ng</button></div>
  <button id="fabScan" class="fab" title="QuÃ©t mÃ£">â–¦</button>
  <div class="bar-item bell">
    <button id="tabBell">ğŸ””</button>
    <div id="bellNum" class="bell-badge" style="display:none">0</div>
  </div>
</nav>

<!-- Sheet ÄÆ N HÃ€NG -->
<div id="ordersWrap" class="sheet-wrap">
  <div id="ordersSheet" class="sheet" role="dialog" aria-modal="true">
    <div class="sheet-header" id="ordersHeader">
      <div class="grip"></div>
      <div class="row" style="justify-content:space-between;pointer-events:none">
        <h3 style="margin:0;pointer-events:none">ğŸ“¦ ÄÆ¡n hÃ ng</h3>
        <div style="pointer-events:auto"><select id="statusFilter">
          <option value="">Táº¥t cáº£</option>
          <option>ÄÃ£ kiá»ƒm Ä‘Æ¡n</option>
          <option>Äang giao hÃ ng</option>
          <option>Giao thÃ nh cÃ´ng</option>
        </select></div>
      </div>
    </div>
    <div id="ordersBody" class="sheet-body">
      <div id="ordersList"></div>
      <div id="ordersEmpty" class="muted" style="display:none">ChÆ°a cÃ³ dá»¯ liá»‡u.</div>
    </div>
  </div>
</div>

<!-- Sheet CHI TIáº¾T -->
<div id="detailWrap" class="sheet-wrap">
  <div id="detailSheet" class="sheet" role="dialog" aria-modal="true">
    <div class="sheet-header" id="detailHeader">
      <div class="grip"></div>
      <div class="detail-head">
        <button id="backOrders" class="small-btn" type="button">â¬…ï¸ ÄÆ¡n hÃ ng</button>
        <div id="detailTitle" style="font-weight:800"></div>
      </div>
    </div>
    <div class="sheet-body">
      <table class="table" id="ctTable">
        <thead><tr><th>TÃªn hÃ ng</th><th>SL</th><th>ÄG</th><th>TT</th></tr></thead>
        <tbody id="ctBody"></tbody>
      </table>
    </div>
  </div>
</div>


<div id="toast" style="display:none;position:fixed;left:50%;bottom:calc(var(--barh)+10px);transform:translateX(-50%);background:#111827;color:#fff;padding:10px 14px;border-radius:10px;font-size:14px;box-shadow:0 8px 24px rgba(0,0,0,.25);z-index:9999"></div>



<!-- === GEO BOTTOM SHEET === -->
<div id="geoWrap" class="sheetWrap" style="display:none">
  <div id="geoSheet" class="sheet">
    <div id="geoHeader" class="sheetHeader">
      <div class="dragBar"></div>
      <div class="title">Gá»­i vá»‹ trÃ­ giao hÃ ng?</div>
    </div>

    <div class="sheetBody">
      <p id="geoMsg2" style="margin: 8px 0 16px">
        ÄÃ£ cáº­p nháº­t tráº¡ng thÃ¡i <b>Giao thÃ nh cÃ´ng</b>. Báº¡n cÃ³ muá»‘n gá»­i kÃ¨m toáº¡ Ä‘á»™, link báº£n Ä‘á»“ vÃ  áº£nh chá»¥p Ä‘á»ƒ lÆ°u láº¡i Ä‘iá»ƒm giao khÃ´ng?
      </p>

      <div class="row" style="gap:8px; display:flex">
        <button id="geoSend" class="btn primary" style="flex:1">ğŸ“ Gá»­i vá»‹ trÃ­</button>
        <button id="geoClose2" class="btn" style="flex:1">ThoÃ¡t</button>
      </div>

      <div id="geoHint" style="color:#8892a6; font-size:12px; margin-top:10px">
        (Há»‡ thá»‘ng sáº½ xin quyá»n Ä‘á»‹nh vá»‹, chá»¥p áº£nh tá»« camera náº¿u Ä‘ang má»Ÿ. Thá»i gian lÆ°u theo giá» Viá»‡t Nam â€” dd/MM/yyyy HH:mm)
      </div>
    </div>
  </div>
</div>
<!-- === /GEO BOTTOM SHEET === -->

<audio id="beep" preload="auto">
  <source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" type="audio/ogg">
  <source src="https://actions.google.com/sounds/v1/alarms/beep_short.mp3" type="audio/mpeg">
</audio>


<!-- JS Ä‘Ã£ tÃ¡ch -->
<script src="./app_dh.js"></script>

</body>
</html>
<!-- ====================== Káº¾T THÃšC: index.html ====================== -->
